<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Good Idea / Bad Idea</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .logo-text {
            font-size: 1.6rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .logo-subtitle {
            font-size: 0.7rem;
            color: #666;
            margin-top: -4px;
        }

        .header-buttons {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header-nav-button, .hamburger-menu {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.2);
            cursor: pointer;
            padding: 8px 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 60px;
            height: 34px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        .header-nav-button:hover, .hamburger-menu:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.4);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.25);
        }

        .header-nav-button.active, .hamburger-menu.active {
            background: rgba(102, 126, 234, 0.25);
            border-color: rgba(102, 126, 234, 0.6);
            color: #4a5fd8;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* Vote Symbol - Simple thumbs up and down */
        .vote-symbol {
            display: flex;
            align-items: center;
            gap: 2px;
            width: 20px;
            height: 20px;
        }

        .thumb-up, .thumb-down {
            width: 8px;
            height: 8px;
            background: #333;
            border-radius: 50%;
            position: relative;
        }

        .thumb-up::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 1px;
            width: 6px;
            height: 6px;
            background: #333;
            border-radius: 50% 50% 0 0;
        }

        .thumb-down::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 1px;
            width: 6px;
            height: 6px;
            background: #333;
            border-radius: 0 0 50% 50%;
        }

        .header-nav-button.active .thumb-up,
        .header-nav-button.active .thumb-down,
        .header-nav-button.active .thumb-up::before,
        .header-nav-button.active .thumb-down::before {
            background: #667eea;
        }

        /* Submit Symbol - Simple speech bubble */
        .submit-symbol {
            position: relative;
            width: 20px;
            height: 20px;
        }

        .speech-bubble {
            width: 16px;
            height: 12px;
            background: #333;
            border-radius: 8px 8px 2px 8px;
            position: relative;
        }

        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -4px;
            right: 2px;
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 4px solid #333;
        }

        .question-mark {
            position: absolute;
            top: 2px;
            left: 6px;
            color: white;
            font-size: 8px;
            font-weight: bold;
            line-height: 1;
        }

        .header-nav-button.active .speech-bubble {
            background: #667eea;
        }

        .header-nav-button.active .speech-bubble::after {
            border-top-color: #667eea;
        }

        /* Hamburger Menu */
        .hamburger-menu {
            flex-direction: column;
            gap: 3px;
            padding: 8px 12px;
            min-width: 50px;
        }

        .hamburger-menu span {
            width: 18px;
            height: 2px;
            background: #667eea;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .hamburger-menu:hover span {
            background: #4a5fd8;
        }

        .hamburger-menu.active span {
            background: #4a5fd8;
        }

        .main-content {
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        .contextual-button {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 50;
        }

        .contextual-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .side-menu {
            position: fixed;
            top: 0;
            left: -280px;
            width: 280px;
            height: 100%;
            background: #333;
            color: white;
            padding: 20px;
            transition: left 0.3s ease;
            z-index: 1000;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }

        .side-menu.open {
            left: 0;
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #555;
        }

        .menu-header .logo-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.8rem;
        }

        .close-menu {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .menu-icon {
            font-size: 1.3rem;
            width: 30px;
            text-align: center;
        }

        .menu-text {
            font-size: 1rem;
            font-weight: 500;
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 999;
            backdrop-filter: blur(2px);
        }

        .menu-overlay.open {
            display: block;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .stat {
            text-align: center;
            min-width: 60px;
        }

        .stat-number {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .stat-label {
            font-size: 0.7rem;
            color: #666;
            margin-top: 2px;
        }

        .card-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            max-width: 400px;
            min-height: 550px;
            height: 550px;
            position: relative;
            transition: transform 0.3s ease;
            cursor: grab;
            display: flex;
            flex-direction: column;
            touch-action: pan-y;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        .card:active {
            cursor: grabbing;
        }

        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-y: auto;
            max-height: 100%;
            padding-right: 5px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
        }

        .card-content::-webkit-scrollbar {
            width: 6px;
        }

        .card-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .card-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .card-content::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .category {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            align-self: flex-start;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .description {
            margin: 15px 0;
            line-height: 1.5;
            color: #666;
            overflow: visible;
            position: relative;
            word-wrap: break-word;
        }

        .description.truncated {
            max-height: 4.5em; /* 3 lines of text */
            overflow: hidden;
        }

        .description.truncated::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 50px;
            height: 1.5em;
            background: linear-gradient(to right, transparent, white);
        }

        .media-container {
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
            max-width: 100%;
            flex-shrink: 0;
        }

        .media-image {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
            border-radius: 10px;
        }

        .media-video {
            width: 100%;
            max-width: 100%;
            height: auto;
            max-height: 200px;
            border-radius: 8px;
            object-fit: cover;
            background: #000;
            display: block;
            margin: 10px 0;
        }

        .media-video::-webkit-media-controls {
            display: none !important;
        }

        .media-video::-webkit-media-controls-panel {
            display: none !important;
        }

        .media-video::-webkit-media-controls-play-button {
            display: none !important;
        }

        .media-video::-webkit-media-controls-start-playback-button {
            display: none !important;
        }

        .media-video::-webkit-media-controls-fullscreen-button {
            display: none !important;
        }

        .media-video::-webkit-media-controls-picture-in-picture-button {
            display: none !important;
        }

        .media-caption {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            text-align: center;
            font-style: italic;
        }

        .read-more {
            color: #667eea;
            cursor: pointer;
            font-weight: bold;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .read-more:hover {
            text-decoration: underline;
        }

        .author {
            color: #999;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .votes {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-top: 1px solid #eee;
            margin-bottom: 60px;
        }

        .vote-count {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #666;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .action-button {
            width: 65px;
            height: 65px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .action-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .action-button:active {
            transform: scale(1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .action-button.skip {
            background: linear-gradient(135deg, #ffda79 0%, #f39c12 100%);
            color: white;
        }

        .action-button.skip:hover {
            background: linear-gradient(135deg, #ffe291 0%, #fab937 100%);
        }

        .action-button.bad {
            background: linear-gradient(135deg, #ff758c 0%, #ff4d4d 100%);
            color: white;
        }

        .action-button.bad:hover {
            background: linear-gradient(135deg, #ff8a9e 0%, #ff6b6b 100%);
        }

        .action-button.good {
            background: linear-gradient(135deg, #4dff88 0%, #2ed573 100%);
            color: white;
        }

        .action-button.good:hover {
            background: linear-gradient(135deg, #6bff9f 0%, #3fe08b 100%);
        }

        .swipe-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: bold;
            padding: 20px;
            border-radius: 10px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .swipe-overlay.good {
            background: rgba(46, 213, 115, 0.9);
            color: white;
        }

        .swipe-overlay.bad {
            background: rgba(255, 71, 87, 0.9);
            color: white;
        }

        .swipe-overlay.show {
            opacity: 1;
        }

        .follow-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }

        .follow-button:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .follow-button.following {
            background: #2ed573;
        }

        .outcome-dashboard {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .outcome-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .close-button {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .outcome-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .outcome-card.success {
            border-left-color: #2ed573;
        }

        .outcome-card.failure {
            border-left-color: #ff4757;
        }

        .outcome-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .outcome-title {
            font-weight: bold;
            color: #333;
        }

        .outcome-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .outcome-status.decided {
            background: #e3f2fd;
            color: #1976d2;
        }

        .outcome-status.success {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .outcome-status.failure {
            background: #ffebee;
            color: #c62828;
        }

        .progress-updates {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .progress-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 10px;
        }

        .progress-date {
            font-size: 0.8rem;
            color: #666;
            margin-right: 10px;
        }

        .progress-text {
            flex-grow: 1;
        }

        .success-badge {
            background: #2ed573;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .engagement-prompt {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 400px;
            text-align: center;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100%); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(0); opacity: 1; }
            to { transform: translateX(-50%) translateY(100%); opacity: 0; }
        }

        .engagement-button {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .engagement-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .no-more-ideas {
            text-align: center;
            color: white;
            font-size: 1.2rem;
            margin-top: 50px;
        }

        .tab-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tab-button {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .tab-button.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Quality Control & Submission Features */
        .quality-indicators {
            display: flex;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .quality-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .quality-badge.verified {
            background: #00b894;
            color: white;
        }

        .quality-badge.expert {
            background: #0984e3;
            color: white;
        }

        .quality-badge.community {
            background: #fdcb6e;
            color: #333;
        }

        .quality-badge.new {
            background: #e17055;
            color: white;
        }

        .reputation-score {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: #666;
        }

        .reputation-score .stars {
            color: #ffd700;
        }

        .submission-form {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .tier-selection {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }

        .tier-option {
            flex: 1;
            padding: 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tier-option:hover {
            border-color: #667eea;
        }

        .tier-option.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .tier-option.free {
            border-color: #ddd;
        }

        .tier-option.premium {
            border-color: #ffd700;
        }

        .tier-option.pro {
            border-color: #00b894;
        }

        .tier-option.enterprise {
            border-color: #636e72;
        }

        .tier-option.free {
            border-color: #ddd;
        }

        .tier-option.premium {
            border-color: #ffd700;
        }

        .tier-option.pro {
            border-color: #00b894;
        }

        .tier-option.enterprise {
            border-color: #636e72;
        }

        .tier-price {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .submit-button {
            /* Header button styles are inherited from .header-nav-button */
        }

        .submit-button:hover {
            /* Header button hover styles are inherited from .header-nav-button:hover */
        }

        .quality-control-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: white;
            backdrop-filter: blur(10px);
        }

        .quality-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .metric {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .moderation-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .mod-button {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: transform 0.2s;
        }

        .mod-button.approve {
            background: #2ed573;
            color: white;
        }

        .mod-button.flag {
            background: #ff4757;
            color: white;
        }

        .mod-button.review {
            background: #ffd700;
            color: #333;
        }

        .mod-button:hover {
            transform: scale(1.05);
        }

        .user-profile {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .profile-info h3 {
            margin: 0;
            color: #333;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            text-align: center;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .submission-guidelines {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .guidelines h4 {
            margin: 0 0 15px 0;
            color: #333;
        }

        .guidelines ul {
            margin: 0;
            padding-left: 20px;
        }

        .guidelines li {
            margin-bottom: 8px;
            color: #666;
        }

        /* Family/Friend Group Features */
        .group-management {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .group-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .group-name {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .group-members {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }

        .member-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .invite-section {
            background: #e8f5e8;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .invite-input {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .invite-input input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        .invite-button {
            background: #2ed573;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* While You Wait Features */
        .waiting-prompt {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: white;
            text-align: center;
        }

        .waiting-prompt h3 {
            margin-bottom: 10px;
            font-size: 1.3rem;
        }

        .waiting-stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
        }

        .waiting-stat {
            text-align: center;
        }

        .waiting-number {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .waiting-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        /* Social Credit System */
        .social-credit {
            background: #fff3cd;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }

        .credit-score {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .credit-number {
            font-size: 2rem;
            font-weight: bold;
            color: #856404;
        }

        .credit-badges {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }

        .credit-badge {
            background: #856404;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        /* Notifications System */
        .notifications-panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .notification-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
        }

        .notification-item:hover {
            background: #f8f9ff;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .notification-icon.success {
            background: #d4edda;
            color: #155724;
        }

        .notification-icon.update {
            background: #cce5ff;
            color: #004085;
        }

        .notification-icon.reminder {
            background: #fff3cd;
            color: #856404;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .notification-time {
            font-size: 0.8rem;
            color: #666;
        }

        /* Analytics Dashboard */
        .analytics-dashboard {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .analytics-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }

        .analytics-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .analytics-label {
            color: #666;
            font-size: 0.9rem;
        }

        .analytics-trend {
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .trend-up {
            color: #2ed573;
        }

        .trend-down {
            color: #ff4757;
        }

        /* Success Stories */
        .success-stories {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .story-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid #2ed573;
        }

        .story-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .story-title {
            font-weight: bold;
            color: #333;
        }

        .story-rating {
            color: #ffd700;
            font-size: 1.2rem;
        }

        .story-content {
            color: #666;
            line-height: 1.6;
        }

        /* Prediction Accuracy */
        .prediction-accuracy {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .accuracy-meter {
            background: #ddd;
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }

        .accuracy-fill {
            background: linear-gradient(90deg, #ff4757 0%, #ffd700 50%, #2ed573 100%);
            height: 100%;
            transition: width 0.3s;
        }

        /* Choice-based Questions */
        .choice-question {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: white;
            width: 100%;
            min-width: 320px;
        }

        .choice-options {
            display: flex;
            gap: 15px;
            margin: 20px 0 60px 0;
            width: 100%;
            justify-content: center;
            align-items: center;
        }

        .choice-option {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 8px 4px;
            text-align: center;
            position: relative;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s;
            min-width: 60px;
            max-width: 120px;
            height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .choice-option:hover {
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }

        .choice-option.option-a {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .choice-option.option-b {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .choice-option.option-c {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .choice-option.option-d {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .choice-text {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .choice-swipe {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .choice-votes {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .question-type-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .question-type-indicator.choice {
            background: #9b59b6;
        }

        .question-type-indicator.good-bad {
            background: #e74c3c;
        }

        /* Notification animations */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .char-count {
            font-size: 0.8rem;
            color: #666;
            text-align: right;
            margin-top: 5px;
        }

        .premium-limit {
            color: #667eea;
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .profile-section {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .profile-section h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .profile-stats .stat {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .profile-stats .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .profile-stats .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .badges-section {
            margin-bottom: 30px;
        }

        .badges-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: capitalize;
        }

        .badge.verified {
            background: #2ed573;
            color: white;
        }

        .badge.expert {
            background: #ffa502;
            color: white;
        }

        .groups-section {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .groups-section h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .group-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .group-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .group-card h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .group-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .group-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .group-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .group-button:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .group-card.create-new {
            border: 2px dashed #ddd;
            background: #f8f9fa;
        }

        .group-invites {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .group-invites h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .invite-form {
            display: flex;
            gap: 10px;
        }

        .invite-form input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        .invite-form button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .recent-activity {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .recent-activity h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .side-menu {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100%;
            background: #333;
            color: white;
            padding: 20px;
            transition: left 0.3s ease;
            z-index: 1000;
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .menu-icon {
            font-size: 1.2rem;
        }

        .menu-text {
            font-size: 0.9rem;
        }

        .close-menu {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 999;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            position: relative;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-y: auto;
            max-height: 100%;
            padding-right: 5px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y;
        }

        .card-content::-webkit-scrollbar {
            width: 6px;
        }

        .card-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .card-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .card-content::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 10px 0;
        }

        .action-button {
            width: 65px;
            height: 65px;
            border: 3px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .action-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .action-button:active {
            transform: scale(1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .action-button.skip {
            background: linear-gradient(135deg, #ffda79 0%, #f39c12 100%);
            color: white;
        }

        .action-button.skip:hover {
            background: linear-gradient(135deg, #ffe291 0%, #fab937 100%);
        }

        .action-button.bad {
            background: linear-gradient(135deg, #ff758c 0%, #ff4d4d 100%);
            color: white;
        }

        .action-button.bad:hover {
            background: linear-gradient(135deg, #ff8a9e 0%, #ff6b6b 100%);
        }

        .action-button.good {
            background: linear-gradient(135deg, #4dff88 0%, #2ed573 100%);
            color: white;
        }

        .action-button.good:hover {
            background: linear-gradient(135deg, #6bff9f 0%, #3fe08b 100%);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 15px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .submit-form {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }

        .submit-form h2 {
            margin-top: 0;
            color: #333;
            text-align: center;
        }

        .submit-form p {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .char-count {
            text-align: right;
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }

        .premium-limit {
            color: #667eea;
            font-weight: 500;
        }

        .tier-selection {
            margin: 30px 0;
        }

        .tier-selection h3 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .tier-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .tier-option {
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .tier-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .tier-option.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .tier-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .tier-header h4 {
            margin: 0 0 5px 0;
            color: #333;
        }

        .tier-price {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
        }

        .tier-option ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .tier-option li {
            padding: 5px 0;
            font-size: 0.9rem;
            color: #666;
        }

        .tier-option li:before {
            content: "";
            color: #4CAF50;
            font-weight: bold;
            margin-right: 8px;
        }

        .submit-button {
            width: 100%;
            background: #667eea;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .submit-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .profile-section,
        .groups-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }

        .profile-section h2,
        .groups-section h2 {
            margin-top: 0;
            color: #333;
            text-align: center;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .badges-section,
        .recent-activity {
            margin: 30px 0;
        }

        .badges-section h3,
        .recent-activity h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .badge.verified {
            background: #4CAF50;
            color: white;
        }

        .badge.expert {
            background: #FF9800;
            color: white;
        }

        .group-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .group-card {
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            background: white;
        }

        .group-card h3 {
            margin-top: 0;
            color: #333;
        }

        .group-card p {
            color: #666;
            margin-bottom: 15px;
        }

        .group-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .group-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .group-button:hover {
            background: #5a6fd8;
        }

        .group-card.create-new {
            border-style: dashed;
            border-color: #667eea;
            text-align: center;
        }

        .invite-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .invite-form input {
            flex: 1;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
        }

        .invite-form button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .engagement-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            margin: 20px 0;
        }

        .engagement-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .outcome-dashboard {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .outcome-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
        }

        .close-button {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .outcome-content h2 {
            margin-top: 0;
            color: #333;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .main-content {
                padding: 15px;
            }

            .card {
                padding: 20px;
                min-height: 350px;
            }

            .action-buttons {
                gap: 15px;
            }

            .action-button {
                width: 55px;
                height: 55px;
                font-size: 1.3rem;
            }

            .stats {
                padding: 12px;
            }

            .stat-number {
                font-size: 1.3rem;
            }

            .submit-form,
            .profile-section,
            .groups-section {
                padding: 20px;
            }

            .tier-options {
                grid-template-columns: 1fr;
            }

            .group-cards {
                grid-template-columns: 1fr;
            }

            .invite-form {
                flex-direction: column;
            }

            .contextual-button {
                bottom: 80px;
                right: 15px;
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }

        .page-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            padding: 0 10px;
        }

        .nav-button {
            flex: 1;
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .nav-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .nav-button:active {
            transform: translateY(0);
        }

        /* Vote overlay pop-ups */
        .vote-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            z-index: 10;
            animation: overlayFadeIn 0.3s ease;
        }

        .vote-overlay.good {
            background: rgba(76, 175, 80, 0.9);
        }

        .vote-overlay.bad {
            background: rgba(244, 67, 54, 0.9);
        }

        .vote-overlay.skip {
            background: rgba(255, 152, 0, 0.9);
        }

        .vote-overlay.choice-a {
            background: rgba(156, 39, 176, 0.9);
        }

        .vote-overlay.choice-b {
            background: rgba(33, 150, 243, 0.9);
        }

        @keyframes overlayFadeIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .header-submit-button {
            /* No extra styles needed, but this class is for clarity and future tweaks */
        }
        /* .submit-button styles below only affect the form button, not the header */

        /* Grouped Questions Feature */
        .grouped-questions-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .grouped-questions-section h3 {
            color: white;
            margin-top: 0;
            font-size: 1.4rem;
        }

        .grouped-questions-section p {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        .group-creation {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .group-creation .form-group {
            margin-bottom: 20px;
        }

        .group-creation label {
            color: white;
            font-weight: 600;
        }

        .group-creation input,
        .group-creation textarea,
        .group-creation select {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #333;
        }

        .group-creation input:focus,
        .group-creation textarea:focus,
        .group-creation select:focus {
            border-color: rgba(255, 255, 255, 0.8);
            background: white;
        }

        .create-group-button {
            background: #2ed573;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
            box-shadow: 0 5px 15px rgba(46, 213, 115, 0.3);
        }

        .create-group-button:hover {
            background: #26d0aa;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(46, 213, 115, 0.4);
        }

        .create-group-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Group Invitation Notification */
        .group-invitation-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 350px;
            animation: slideInRight 0.5s ease;
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .group-invitation-notification h4 {
            margin: 0 0 10px 0;
            font-size: 1.2rem;
        }

        .group-invitation-notification p {
            margin: 0 0 15px 0;
            opacity: 0.9;
        }

        .group-invitation-notification .incentive {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 600;
        }

        .group-invitation-buttons {
            display: flex;
            gap: 10px;
        }

        .group-invitation-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .accept-group-btn {
            background: #2ed573;
            color: white;
        }

        .accept-group-btn:hover {
            background: #26d0aa;
        }

        .decline-group-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .decline-group-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Premium Feature Lock */
        .premium-lock {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .premium-lock h4 {
            color: white;
            margin: 0 0 10px 0;
        }

        .premium-lock p {
            color: rgba(255, 255, 255, 0.8);
            margin: 0 0 15px 0;
        }

        .upgrade-button {
            background: #ffd700;
            color: #333;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upgrade-button:hover {
            background: #ffed4e;
            transform: translateY(-2px);
        }

        /* Grouped Question Indicator */
        .grouped-question-indicator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            margin: 0 0 20px 0;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px;
        }

        .group-info h4 {
            margin: 0 0 8px 0;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .group-progress {
            margin: 0 0 8px 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .group-incentive {
            margin: 0;
            font-size: 0.9rem;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 8px;
            display: inline-block;
        }

        .exit-group-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .exit-group-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .progress-bar {
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #2ed573;
            transition: width 0.5s ease;
            border-radius: 0 3px 3px 0;
        }

        /* Group Completion Screen */
        .group-completion-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            padding: 40px 20px;
        }

        .completion-content {
            text-align: center;
            max-width: 500px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .completion-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .completion-content h2 {
            color: #333;
            margin: 0 0 15px 0;
            font-size: 1.8rem;
        }

        .completion-content p {
            color: #666;
            margin: 0 0 15px 0;
            line-height: 1.6;
        }

        .completion-incentive {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
        }

        .return-to-voting-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .return-to-voting-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* Choice voting buttons - smaller and less intrusive */
        .choice-buttons {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            justify-content: center;
        }

        .choice-button {
            padding: 4px 8px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            color: #666;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 50px;
            text-align: center;
        }

        .choice-button:hover {
            border-color: #007bff;
            color: #007bff;
            transform: translateY(-1px);
        }

        .choice-button.choice-a {
            border-color: #6f42c1;
            color: #6f42c1;
        }

        .choice-button.choice-b {
            border-color: #007bff;
            color: #007bff;
        }

        .choice-button.choice-a:hover {
            background: #6f42c1;
            color: white;
        }

        .choice-button.choice-b:hover {
            background: #007bff;
            color: white;
        }

        /* Swipe feedback highlights */
        .swipe-feedback {
            position: fixed;
            top: 0;
            width: 250px;
            height: 100vh;
            pointer-events: none;
            z-index: 1000;
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .swipe-feedback.left {
            left: 0;
            background: linear-gradient(to right, rgba(220, 53, 69, 0.8), rgba(220, 53, 69, 0.2), transparent);
        }

        .swipe-feedback.right {
            right: 0;
            background: linear-gradient(to left, rgba(40, 167, 69, 0.8), rgba(40, 167, 69, 0.2), transparent);
        }

        .swipe-feedback.choice-left {
            left: 0;
            background: linear-gradient(to right, rgba(111, 66, 193, 0.8), rgba(111, 66, 193, 0.2), transparent);
        }

        .swipe-feedback.choice-right {
            right: 0;
            background: linear-gradient(to left, rgba(0, 123, 255, 0.8), rgba(0, 123, 255, 0.2), transparent);
        }

        .swipe-feedback .feedback-icon {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            padding: 0 25px;
            word-wrap: break-word;
            font-size: 40px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .swipe-feedback.left .feedback-icon,
        .swipe-feedback.choice-left .feedback-icon {
            text-align: left;
        }

        .swipe-feedback.right .feedback-icon,
        .swipe-feedback.choice-right .feedback-icon {
            text-align: right;
        }

        .metadata-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .quality-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .quality-badge.verified {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .quality-badge.expert {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .quality-badge.community {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .quality-badge.new {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .reputation-score {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
            color: #666;
        }

        .reputation-score .stars {
            color: #ffd700;
        }

        .reputation-score .score {
            font-weight: bold;
        }

        .tier-badge {
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .tier-badge.free {
            background: #e8f5e8;
            color: #2d5a2d;
            border: 1px solid #4caf50;
        }

        .tier-badge.premium {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ff9800;
        }

        .tier-badge.pro {
            background: #e3f2fd;
            color: #1565c0;
            border: 1px solid #2196f3;
        }

        .tier-badge.enterprise {
            background: #f3e5f5;
            color: #7b1fa2;
            border: 1px solid #9c27b0;
        }

        .target-audience {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
            margin-top: 8px;
            padding: 4px 8px;
            background: #f5f5f5;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }
    </style>
</head>
<body>
    <!-- Swipe feedback highlights -->
    <div class="swipe-feedback left" id="swipeFeedbackLeft">
        <div class="feedback-icon"></div>
    </div>
    <div class="swipe-feedback right" id="swipeFeedbackRight">
        <div class="feedback-icon"></div>
    </div>
    <div class="swipe-feedback choice-left" id="swipeFeedbackChoiceLeft">
        <div class="feedback-icon">A</div>
    </div>
    <div class="swipe-feedback choice-right" id="swipeFeedbackChoiceRight">
        <div class="feedback-icon">B</div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="logo">
            <span class="logo-text">GIBI</span>
            <span class="logo-subtitle">Good Idea Bad Idea</span>
        </div>
        <div class="header-buttons">
            <button class="header-nav-button vote-button" onclick="showTab('voting')" title="Vote">Vote</button>
            <button class="header-nav-button header-submit-button" onclick="showTab('submit')" title="Submit">Submit</button>
            <button class="hamburger-menu" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>

    <div class="main-content">
        <div id="voting-tab" class="tab-content active">
            <div class="card-container" id="cardContainer">
                <div class="card" id="currentCard">
                    <div class="card-content">
                        <div>
                            <div class="category" id="ideaCategory">Food</div>
                            <div class="metadata-row">
                                <div class="quality-badge" id="qualityBadge" style="display: none;"></div>
                                <div class="reputation-score" id="reputationScore" style="display: none;">
                                    <span class="stars"></span>
                                    <span class="score"></span>
                                </div>
                                <div class="tier-badge" id="tierBadge" style="display: none;"></div>
                            </div>
                            <h2 class="card-title" id="ideaTitle">Pizza for dinner tonight?</h2>
                            <p class="description" id="ideaDescription">Should we order pizza for dinner? I'm craving some pepperoni!</p>
                            <div class="target-audience" id="targetAudience" style="display: none;"></div>
                            <div class="media-container" id="mediaContainer" style="display: none;">
                                <!-- Media content will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- Good/Bad Question Layout -->
                        <div id="goodBadLayout">
                            <div class="author" id="ideaAuthor"> Sarah</div>
                            <div class="votes">
                                <div class="vote-count">
                                     <span id="goodVotes">45</span>
                                </div>
                                <div class="vote-count">
                                     <span id="badVotes">12</span>
                                </div>
                            </div>
                        </div>

                        <!-- Choice Question Layout -->
                        <div id="choiceLayout" style="display: none;">
                            <div class="author" id="choiceAuthor"> Sarah</div>
                            <div class="choice-options">
                                <div class="choice-option option-a" onclick="voteChoice('a')" ontouchend="event.preventDefault(); voteChoice('a');">
                                    <div class="choice-swipe"></div>
                                    <div class="choice-text" id="choiceA">Option A</div>
                                    <div class="choice-votes" id="votesA">0 votes</div>
                                </div>
                                <div class="choice-option option-b" onclick="voteChoice('b')" ontouchend="event.preventDefault(); voteChoice('b');">
                                    <div class="choice-swipe"></div>
                                    <div class="choice-text" id="choiceB">Option B</div>
                                    <div class="choice-votes" id="votesB">0 votes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swipe-overlay" id="swipeOverlay"></div>
                    <button class="follow-button" id="followButton" onclick="followIdea()">Follow for Updates</button>
                    <div class="question-type-indicator" id="questionTypeIndicator">Good/Bad</div>
                </div>
            </div>

            <div class="action-buttons" id="goodBadButtons">
                <button class="action-button bad" onclick="vote('bad')"></button>
                <button class="action-button skip" onclick="vote('skip')"></button>
                <button class="action-button good" onclick="vote('good')"></button>
            </div>

            <div class="action-buttons" id="choiceButtons" style="display: none; justify-content: center;">
                <button class="action-button skip" onclick="vote('skip')"></button>
            </div>

            <div class="engagement-prompt" id="engagementPrompt" style="display: none;">
                <h3> Great Voting!</h3>
                <p>You've voted on 5 ideas! While you wait for responses, help 3 more people with their decisions to unlock premium features.</p>
                <button class="engagement-button" onclick="continueVoting()">Continue Helping Others</button>
            </div>
        </div>

        <div id="submit-tab" class="tab-content">
            <div class="submit-form">
                <h2>Submit Your Idea</h2>
                <p>Get community feedback on your decisions</p>
                
                <div class="form-group">
                    <label for="ideaTitle">Idea Title *</label>
                    <input type="text" id="ideaTitle" placeholder="Brief, clear title" maxlength="100">
                    <div class="char-count">
                        <span id="titleCount">0</span>/100
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ideaDescription">Description *</label>
                    <textarea id="ideaDescription" placeholder="Explain your idea and why you need help deciding" maxlength="300"></textarea>
                    <div class="char-count">
                        <span id="descCount">0</span>/300
                        <span class="premium-limit" id="premiumLimit" style="display: none;"> (Premium: 500 chars)</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="ideaCategory">Category *</label>
                    <select id="ideaCategory">
                        <option value="">Select a category</option>
                        <option value="Gaming">Gaming</option>
                        <option value="Business">Business</option>
                        <option value="Tech">Tech</option>
                        <option value="Health">Health</option>
                        <option value="Creative Arts">Creative Arts</option>
                        <option value="Education">Education</option>
                        <option value="Lifestyle">Lifestyle</option>
                        <option value="Professional">Professional</option>
                        <option value="Community">Community</option>
                        <option value="Finance">Finance</option>
                        <option value="Environment">Environment</option>
                        <option value="Family">Family</option>
                        <option value="Fandoms">Fandoms</option>
                        <option value="Sports">Sports</option>
                        <option value="Food">Food</option>
                        <option value="Travel">Travel</option>
                        <option value="Music">Music</option>
                        <option value="Photography">Photography</option>
                        <option value="Fitness">Fitness</option>
                        <option value="Cooking">Cooking</option>
                        <option value="Art">Art</option>
                        <option value="Pets">Pets</option>
                        <option value="Gardening">Gardening</option>
                        <option value="DIY">DIY/Home</option>
                        <option value="Social Media">Social Media</option>
                        <option value="Dating">Dating</option>
                        <option value="Mental Health">Mental Health</option>
                        <option value="Entertainment">Entertainment</option>
                        <option value="Innovation">Innovation</option>
                        <option value="Politics">Politics</option>
                        <option value="Science">Science</option>
                        <option value="Journalism">Journalism</option>
                        <option value="Comedy">Comedy</option>
                        <option value="Fashion">Fashion</option>
                        <option value="Medicine">Medicine</option>
                        <option value="Movies">Movies</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="targetAudience">Target Audience (Optional)</label>
                    <input type="text" id="targetAudience" placeholder="e.g., Indie Game Developers, Small Business Owners">
                </div>
                
                <div class="form-group">
                    <label for="visibility">Visibility</label>
                    <select id="visibility">
                        <option value="public">Public - Anyone can vote</option>
                        <option value="private">Private - Group members only</option>
                    </select>
                </div>
                
                <div class="form-group" id="privateGroupSection" style="display: none;">
                    <label for="privateGroup">Group Name</label>
                    <input type="text" id="privateGroup" placeholder="Enter group name">
                </div>
                
                <div class="tier-selection">
                    <h3>Choose Your Tier</h3>
                    <div class="tier-options">
                        <div class="tier-option free selected" onclick="selectTier('free')">
                            <div class="tier-header">
                                <h4>Free</h4>
                                <div class="tier-price">$0</div>
                            </div>
                            <ul>
                                <li>Basic submission</li>
                                <li>Community voting</li>
                                <li>Standard support</li>
                            </ul>
                        </div>
                        
                        <div class="tier-option premium" onclick="selectTier('premium')">
                            <div class="tier-header">
                                <h4>Premium</h4>
                                <div class="tier-price">$9.99/month</div>
                            </div>
                            <ul>
                                <li>Extended description (500 chars)</li>
                                <li>Priority voting</li>
                                <li>Advanced analytics</li>
                                <li>Priority support</li>
                                <li><strong>Grouped Questions (3 groups)</strong></li>
                            </ul>
                        </div>
                        
                        <div class="tier-option pro" onclick="selectTier('pro')">
                            <div class="tier-header">
                                <h4>Pro</h4>
                                <div class="tier-price">$29.99/month</div>
                            </div>
                            <ul>
                                <li>Extended description (750 chars)</li>
                                <li>Targeted audience</li>
                                <li>Advanced analytics</li>
                                <li>Priority support</li>
                                <li>Custom branding</li>
                                <li><strong>Grouped Questions (10 groups)</strong></li>
                            </ul>
                        </div>
                        
                        <div class="tier-option enterprise" onclick="selectTier('enterprise')">
                            <div class="tier-header">
                                <h4>Enterprise</h4>
                                <div class="tier-price">$99.99/month</div>
                            </div>
                            <ul>
                                <li>Extended description (1000 chars)</li>
                                <li>Team collaboration</li>
                                <li>Advanced analytics</li>
                                <li>Dedicated support</li>
                                <li>Custom integrations</li>
                                <li>White-label options</li>
                                <li><strong>Unlimited Grouped Questions</strong></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Grouped Questions Feature (Premium) -->
                <div class="grouped-questions-section" id="groupedQuestionsSection" style="display: none;">
                    <h3> Create Grouped Questions</h3>
                    <p>Send targeted question groups to specific people for focused feedback</p>
                    
                    <div class="group-creation">
                        <div class="form-group">
                            <label for="groupName">Group Name *</label>
                            <input type="text" id="groupName" placeholder="e.g., 'Product Launch Feedback', 'Team Decision Making'">
                        </div>
                        
                        <div class="form-group">
                            <label for="groupDescription">Group Description</label>
                            <textarea id="groupDescription" placeholder="Explain what this group of questions is about and why you're targeting specific people"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="targetEmails">Target Recipients (Email addresses, one per line)</label>
                            <textarea id="targetEmails" placeholder="john@company.com&#10;jane@company.com&#10;mike@company.com"></textarea>
                            <div class="char-count">
                                <span id="emailCount">0</span> recipients
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="incentiveMessage">Incentive Message</label>
                            <textarea id="incentiveMessage" placeholder="What's in it for them? e.g., 'Get early access to our new feature' or 'Receive a $50 gift card'"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="questionCount">Number of Questions in Group</label>
                            <select id="questionCount">
                                <option value="5">5 questions</option>
                                <option value="10" selected>10 questions</option>
                                <option value="15">15 questions</option>
                                <option value="20">20 questions</option>
                            </select>
                        </div>
                        
                        <button class="create-group-button" onclick="createQuestionGroup()">Create Group & Send Invitations</button>
                    </div>
                </div>
                
                <button class="submit-button" onclick="submitIdea()">Submit Idea</button>
            </div>
        </div>

        <div id="outcomes-tab" class="tab-content">
            <div class="outcome-content">
                <h2>Ideas You're Following</h2>
                <div id="followedIdeas">
                    <!-- Outcome cards will be populated here -->
                </div>
            </div>
        </div>

        <div id="profile-tab" class="tab-content">
            <div class="profile-section">
                <h2>My Profile</h2>
                <div class="profile-stats">
                    <div class="stat">
                        <div class="stat-number" id="profileReputation">4.2</div>
                        <div class="stat-label">Reputation</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="profileIdeasVoted">156</div>
                        <div class="stat-label">Ideas Voted</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${userProfile.ideasSubmitted}</div>
                        <div class="stat-label">Ideas Submitted</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number">${userProfile.accuracyRate}%</div>
                        <div class="stat-label">Accuracy Rate</div>
                    </div>
                </div>
                
                <div class="badges-section">
                    <h3>Badges Earned</h3>
                    <div class="badges" id="profileBadges">
                        <span class="badge verified">verified</span>
                        <span class="badge expert">expert</span>
                    </div>
                </div>

                <div class="recent-activity">
                    <h3>Recent Activity</h3>
                    <div id="recentActivity">
                        <!-- Recent activity will be populated here -->
                    </div>
                </div>
            </div>

            <div class="groups-section">
                <h2>My Groups</h2>
                <div class="group-cards">
                    <div class="group-card">
                        <h3>Family Decisions</h3>
                        <p>Private group for family choices</p>
                        <div class="group-stats">
                            <span>5 members</span>
                            <span>12 active ideas</span>
                        </div>
                        <button class="group-button" onclick="inviteToGroup('Family Decisions')">Invite Member</button>
                    </div>
                    
                    <div class="group-card">
                        <h3>Gaming Friends</h3>
                        <p>Group for gaming-related decisions</p>
                        <div class="group-stats">
                            <span>8 members</span>
                            <span>23 active ideas</span>
                        </div>
                        <button class="group-button" onclick="inviteToGroup('Gaming Friends')">Invite Member</button>
                    </div>
                    
                    <div class="group-card create-new">
                        <h3>Create New Group</h3>
                        <p>Start a private group for your decisions</p>
                        <button class="group-button" onclick="createNewGroup()">Create Group</button>
                    </div>
                </div>
                
                <div class="group-invites">
                    <h3>Invite to Group</h3>
                    <div class="invite-form">
                        <input type="email" placeholder="Enter email address" />
                        <button onclick="sendInvite()">Send Invite</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Side Menu -->
    <div class="side-menu" id="sideMenu">
        <div class="menu-header">
            <div class="logo">
                <span class="logo-text">GIBI</span>
            </div>
            <button class="close-menu" onclick="toggleMenu()"></button>
        </div>
        <div class="menu-items">
            <div class="menu-item" onclick="showTab('outcomes'); toggleMenu();">
                <span class="menu-icon"></span>
                <span class="menu-text">Outcomes</span>
            </div>
            <div class="menu-item" onclick="showTab('profile'); toggleMenu();">
                <span class="menu-icon"></span>
                <span class="menu-text">Profile</span>
            </div>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>

    <script>
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            showTab('voting');
            loadNextIdea();
            setupSwipeFunctionality();
            
            // Auto-trigger sports group invitation for testing
            setTimeout(() => {
                triggerSportsGroupInvitation();
            }, 2000);
        });

        // Core app data
        let currentIdeaIndex = 0;
        let goodCount = 0;
        let badCount = 0;
        let skippedCount = 0;
        let followedIdeas = [];
        let shuffledIdeas = [];

        // Swipe functionality variables
        let isDragging = false;
        let startX = 0;
        let startY = 0;

        // Shuffle function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function setupSwipeFunctionality() {
            const card = document.getElementById('currentCard');
            if (!card) return;

            // Get feedback elements
            const feedbackLeft = document.getElementById('swipeFeedbackLeft');
            const feedbackRight = document.getElementById('swipeFeedbackRight');
            const feedbackChoiceLeft = document.getElementById('swipeFeedbackChoiceLeft');
            const feedbackChoiceRight = document.getElementById('swipeFeedbackChoiceRight');

            function showFeedback(direction, isChoice = false) {
                // Hide all feedback first
                feedbackLeft.style.opacity = '0';
                feedbackRight.style.opacity = '0';
                feedbackChoiceLeft.style.opacity = '0';
                feedbackChoiceRight.style.opacity = '0';

                // Show appropriate feedback
                if (isChoice) {
                    if (direction === 'left') {
                        feedbackChoiceLeft.style.opacity = '1';
                    } else if (direction === 'right') {
                        feedbackChoiceRight.style.opacity = '1';
                    }
                } else {
                    if (direction === 'left') {
                        feedbackLeft.style.opacity = '1';
                    } else if (direction === 'right') {
                        feedbackRight.style.opacity = '1';
                    }
                }
            }

            function hideFeedback() {
                feedbackLeft.style.opacity = '0';
                feedbackRight.style.opacity = '0';
                feedbackChoiceLeft.style.opacity = '0';
                feedbackChoiceRight.style.opacity = '0';
            }

            // Touch events for mobile
            card.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                isDragging = true;
            });

            card.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;
                const diffX = currentX - startX;
                const diffY = currentY - startY;
                
                // Only prevent default and handle as swipe if it's primarily horizontal
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 10) {
                    e.preventDefault();
                    card.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
                    
                    // Show feedback based on direction and question type
                    const idea = shuffledIdeas[currentIdeaIndex];
                    if (idea.type === 'choice') {
                        document.querySelector('#swipeFeedbackChoiceLeft .feedback-icon').textContent = document.getElementById('choiceA').textContent;
                        document.querySelector('#swipeFeedbackChoiceRight .feedback-icon').textContent = document.getElementById('choiceB').textContent;
                    }
                    if (diffX > 0) {
                        showFeedback('right', idea.type === 'choice');
                    } else {
                        showFeedback('left', idea.type === 'choice');
                    }
                }
            });

            card.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                
                const currentX = e.changedTouches[0].clientX;
                const currentY = e.changedTouches[0].clientY;
                const diffX = currentX - startX;
                const diffY = currentY - startY;
                
                card.style.transform = '';
                isDragging = false;
                hideFeedback();
                
                // Only trigger vote if it was a horizontal swipe
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 100) {
                    const idea = shuffledIdeas[currentIdeaIndex];
                    if (idea.type === 'choice') {
                        // For choice questions, swipe left = choice A, swipe right = choice B
                        if (diffX < 0) {
                            voteChoice('a');
                        } else {
                            voteChoice('b');
                        }
                    } else {
                        // For good/bad questions
                        if (diffX > 0) {
                            vote('good');
                        } else {
                            vote('bad');
                        }
                    }
                }
            });

            // Mouse drag support for desktop
            card.addEventListener('mousedown', (e) => {
                startX = e.clientX;
                startY = e.clientY;
                isDragging = true;
            });

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const currentX = e.clientX;
                const currentY = e.clientY;
                const diffX = currentX - startX;
                const diffY = currentY - startY;
                
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    card.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
                    
                    // Show feedback based on direction and question type
                    const idea = shuffledIdeas[currentIdeaIndex];
                    if (idea.type === 'choice') {
                        document.querySelector('#swipeFeedbackChoiceLeft .feedback-icon').textContent = document.getElementById('choiceA').textContent;
                        document.querySelector('#swipeFeedbackChoiceRight .feedback-icon').textContent = document.getElementById('choiceB').textContent;
                    }

                    if (diffX > 0) {
                        showFeedback('right', idea.type === 'choice');
                    } else {
                        showFeedback('left', idea.type === 'choice');
                    }
                }
            });

            document.addEventListener('mouseup', (e) => {
                if (!isDragging) return;
                
                const currentX = e.clientX;
                const diffX = currentX - startX;
                
                card.style.transform = '';
                isDragging = false;
                hideFeedback();
                
                if (Math.abs(diffX) > 100) {
                    const idea = shuffledIdeas[currentIdeaIndex];
                    if (idea.type === 'choice') {
                        // For choice questions, drag left = choice A, drag right = choice B
                        if (diffX < 0) {
                            voteChoice('a');
                        } else {
                            voteChoice('b');
                        }
                    } else {
                        // For good/bad questions
                        if (diffX > 0) {
                            vote('good');
                        } else {
                            vote('bad');
                        }
                    }
                }
            });
        }

        // Sample ideas data
        const ideas = [
            {
                id: 1,
                title: "Pizza for dinner tonight?",
                description: "Should we order pizza for dinner? I'm craving some pepperoni!",
                category: "Food",
                author: "Sarah",
                votes: { good: 45, bad: 12 },
                type: "good-bad",
                media: null,
                qualityBadge: "verified",
                reputation: 4.8,
                tier: "pro",
                targetAudience: "Entrepreneurs"
            },
            {
                id: 2,
                title: "Should I learn Rust for backend development?",
                description: "I'm a JavaScript developer looking to expand my skills. Rust seems promising for performance-critical applications, but the learning curve is steep. Should I invest time in learning Rust or stick with Node.js/TypeScript?",
                category: "Tech",
                author: "Alex",
                votes: { good: 78, bad: 15 },
                type: "good-bad",
                media: null,
                qualityBadge: "expert",
                reputation: 4.9,
                tier: "pro",
                targetAudience: "Software developers"
            },
            {
                id: 3,
                title: "Coffee vs Tea for productivity",
                description: "I'm trying to optimize my morning routine. Coffee gives me a quick energy boost but sometimes makes me jittery. Tea is more calming but doesn't give the same kick. Which should I choose for maximum productivity?",
                category: "Lifestyle",
                author: "Jordan",
                votes: { a: 34, b: 28 },
                type: "choice",
                choiceA: "Coffee",
                choiceB: "Tea",
                media: null,
                qualityBadge: "community",
                reputation: 4.2,
                tier: "free",
                targetAudience: "Productivity seekers"
            },
            {
                id: 4,
                title: "Should I start a YouTube channel about indie game development?",
                description: "I've been developing indie games for 2 years and thinking about sharing my journey on YouTube. It could help build a community and potentially attract players to my games. But it's a significant time investment and I'm not sure if anyone would watch. The gaming content space is crowded, but there might be a niche for behind-the-scenes development content.",
                category: "Gaming",
                author: "Maya",
                votes: { good: 92, bad: 8 },
                type: "good-bad",
                media: {
                    type: "image",
                    url: "https://images.unsplash.com/photo-1511512578047-dfb367046420?w=400&h=300&fit=crop",
                    caption: "Indie game development setup"
                },
                qualityBadge: "expert",
                reputation: 4.7,
                tier: "pro",
                targetAudience: "Indie game developers"
            },
            {
                id: 5,
                title: "Should I start a cooking tutorial series?",
                description: "I'm a passionate home cook and thinking about creating cooking tutorial videos. I could share my recipes and techniques, but I'm not sure if there's an audience for my style of cooking. Should I start filming my cooking process?",
                category: "Creative Arts",
                author: "Chef Maria",
                votes: { good: 85, bad: 15 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                    caption: "Cooking tutorial preview"
                },
                qualityBadge: "verified",
                reputation: 4.6,
                tier: "premium",
                targetAudience: "Home cooks and food enthusiasts"
            },
            {
                id: 6,
                title: "Remote work vs Office for team collaboration",
                description: "Our team is debating whether to return to the office or stay remote. Remote work offers flexibility and no commute, but some team members feel isolated and miss the spontaneous collaboration that happens in person. We're a 15-person startup developing a SaaS product.",
                category: "Professional",
                author: "Chris",
                votes: { a: 12, b: 8 },
                type: "choice",
                choiceA: "Remote",
                choiceB: "Office",
                media: null,
                qualityBadge: "verified",
                reputation: 4.3,
                tier: "premium",
                targetAudience: "Startup teams"
            },
            {
                id: 7,
                title: "Should I quit my job to start a business?",
                description: "I have a stable job but I'm passionate about starting my own business. I have some savings and a business plan, but I'm worried about the financial risk and uncertainty. Should I take the leap or keep building my business on the side?",
                category: "Business",
                author: "Emma",
                votes: { good: 67, bad: 33 },
                type: "good-bad",
                media: null
            },
            {
                id: 8,
                title: "MacBook vs Windows laptop for development",
                description: "I need a new laptop for software development. MacBooks have great build quality and Unix-based system, but Windows laptops offer more variety and better value. I primarily work with web technologies and occasionally need to run Windows-specific tools.",
                category: "Tech",
                author: "Taylor",
                votes: { a: 23, b: 18 },
                type: "choice",
                choiceA: "MacBook",
                choiceB: "Windows",
                media: null,
                qualityBadge: "community",
                reputation: 4.1,
                tier: "free",
                targetAudience: "Software developers"
            },
            {
                id: 9,
                title: "Should I move to a different city for better opportunities?",
                description: "I'm considering moving from my current city to a tech hub for better job opportunities and networking. The cost of living is higher, but the potential for career growth is much better. Should I make the move?",
                category: "Professional",
                author: "Lisa",
                votes: { good: 81, bad: 19 },
                type: "good-bad",
                media: null,
                qualityBadge: "verified",
                reputation: 4.4,
                tier: "premium",
                targetAudience: "Career changers"
            },
            {
                id: 10,
                title: "Home gym vs gym membership",
                description: "I want to get fit but can't decide between building a home gym or getting a gym membership. Home gym offers convenience and privacy, but gym membership provides variety and social motivation. I have space for basic equipment at home.",
                category: "Health",
                author: "Mike",
                votes: { a: 52, b: 41 },
                type: "choice",
                choiceA: "Gym",
                choiceB: "Home",
                media: null,
                qualityBadge: "community",
                reputation: 4.0,
                tier: "free",
                targetAudience: "Fitness beginners"
            },
            {
                id: 11,
                title: "Should I learn a new language?",
                description: "I'm considering learning Spanish or Mandarin to expand my career opportunities and travel experiences. It would require significant time investment, but could open up new markets and connections. Is it worth the effort?",
                category: "Education",
                author: "Anna",
                votes: { good: 89, bad: 11 },
                type: "good-bad",
                media: null,
                qualityBadge: "verified",
                reputation: 4.6,
                tier: "premium",
                targetAudience: "Language learners"
            },
            {
                id: 12,
                title: "Buy a house vs continue renting",
                description: "I have enough savings for a down payment on a house, but I'm not sure if it's the right time. Renting gives me flexibility, but buying could be a good investment. The housing market is uncertain right now.",
                category: "Finance",
                author: "Tom",
                votes: { a: 38, b: 62 },
                type: "choice",
                choiceA: "Buy",
                choiceB: "Rent",
                media: null
            },
            {
                id: 13,
                title: "Should I start a podcast?",
                description: "I'm passionate about a niche topic and thinking about starting a podcast. It could help build my personal brand and connect with like-minded people, but it's a lot of work and I'm not sure if anyone would listen.",
                category: "Creative Arts",
                author: "Rachel",
                votes: { good: 73, bad: 27 },
                type: "good-bad",
                media: null,
                qualityBadge: "community",
                reputation: 4.2,
                tier: "free",
                targetAudience: "Content creators"
            },
            {
                id: 14,
                title: "College vs online courses for learning programming",
                description: "I want to learn programming and can't decide between traditional college or online courses. College provides structure and networking, but online courses are more flexible and affordable. I'm motivated to learn but need guidance.",
                category: "Education",
                author: "Kevin",
                votes: { a: 31, b: 69 },
                type: "choice",
                choiceA: "College",
                choiceB: "Online",
                media: null
            },
            {
                id: 15,
                title: "Should I adopt a pet?",
                description: "I'm considering adopting a dog or cat for companionship. I have the time and space, but I'm worried about the responsibility and long-term commitment. Pets can be expensive and require daily care.",
                category: "Lifestyle",
                author: "Sophie",
                votes: { good: 76, bad: 24 },
                type: "good-bad",
                media: null
            },
            {
                id: 16,
                title: "Traditional workout vs HIIT training",
                description: "I want to get fit but can't decide between traditional gym workouts or high-intensity interval training. Traditional workouts build strength gradually, while HIIT burns calories quickly. Which approach should I choose?",
                category: "Health",
                author: "Fitness Coach",
                votes: { a: 45, b: 55 },
                type: "choice",
                choiceA: "Traditional",
                choiceB: "HIIT",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",
                    caption: "Workout comparison"
                },
                qualityBadge: "expert",
                reputation: 4.9,
                tier: "pro",
                targetAudience: "Fitness enthusiasts"
            },
            {
                id: 17,
                title: "Should I start a tech review channel?",
                description: "I'm passionate about technology and thinking about starting a YouTube channel reviewing gadgets and software. I have good technical knowledge and could provide honest reviews, but the tech review space is very competitive.",
                category: "Tech",
                author: "Tech Enthusiast",
                votes: { good: 72, bad: 28 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_5mb.mp4",
                    caption: "Tech review sample"
                }
            },
            {
                id: 26,
                title: "Should I learn to play guitar?",
                description: "I've always wanted to learn guitar and have some free time now. It would be a creative outlet and social skill, but requires consistent practice and I'm not sure if I'll stick with it.",
                category: "Creative Arts",
                author: "Alex",
                votes: { good: 85, bad: 15 },
                type: "good-bad",
                media: null
            },
            {
                id: 27,
                title: "Should I start a tech review channel?",
                description: "I love technology and thinking about starting a YouTube channel reviewing gadgets and software. I have good technical knowledge and could provide honest reviews, but the tech review space is very competitive.",
                category: "Tech",
                author: "Tech Enthusiast",
                votes: { good: 72, bad: 28 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",
                    caption: "Tech review sample"
                },
                qualityBadge: "verified",
                reputation: 4.5,
                tier: "premium",
                targetAudience: "Tech enthusiasts"
            },
            {
                id: 28,
                title: "Should I start a fitness vlog?",
                description: "I'm passionate about fitness and thinking about starting a vlog to share my workout routines and health tips. It could inspire others and build a community, but requires consistent content creation and equipment.",
                category: "Health",
                author: "Fitness Vlogger",
                votes: { good: 78, bad: 22 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4",
                    caption: "Fitness vlog preview"
                }
            },
            {
                id: 29,
                title: "Should I start a travel documentary series?",
                description: "I love traveling and thinking about creating a documentary series about different cultures and destinations. It could be educational and entertaining, but requires significant travel costs and production skills.",
                category: "Creative Arts",
                author: "Travel Filmmaker",
                votes: { good: 81, bad: 19 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4",
                    caption: "Travel documentary sample"
                }
            },
            {
                id: 30,
                title: "Should I start a coding tutorial channel?",
                description: "I'm a software developer and thinking about creating coding tutorial videos. I could help others learn programming, but the tutorial space is very competitive and requires consistent content creation.",
                category: "Education",
                author: "Code Teacher",
                votes: { good: 75, bad: 25 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4",
                    caption: "Coding tutorial preview"
                }
            },
            {
                id: 31,
                title: "Should I start a music performance channel?",
                description: "I'm a musician and thinking about starting a channel to share my performances and music covers. It could build an audience and showcase my talent, but requires recording equipment and consistent content.",
                category: "Creative Arts",
                author: "Musician",
                votes: { good: 83, bad: 17 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4",
                    caption: "Music performance sample"
                }
            },
            {
                id: 32,
                title: "Should I start a DIY craft tutorial series?",
                description: "I love crafting and thinking about creating tutorial videos for DIY projects. I could share my techniques and inspire creativity, but requires materials, equipment, and consistent project ideas.",
                category: "Creative Arts",
                author: "Craft Creator",
                votes: { good: 79, bad: 21 },
                type: "good-bad",
                media: {
                    type: "video",
                    url: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4",
                    caption: "DIY craft tutorial"
                }
            }
        ];

        function showTab(tabName) {
            // Hide all tab content
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Show selected tab content
            const selectedTab = document.getElementById(tabName + '-tab');
            if (selectedTab) {
                selectedTab.classList.add('active');
            }

            // Update header button states
            updateHeaderButtonStates(tabName);
            
            // Populate outcomes tab if showing outcomes
            if (tabName === 'outcomes') {
                populateFollowedIdeas();
            }
        }

        function updateHeaderButtonStates(activeTab) {
            // Remove active class from all header buttons
            document.querySelectorAll('.header-nav-button').forEach(button => {
                button.classList.remove('active');
            });
            document.querySelector('.hamburger-menu').classList.remove('active');

            // Add active class to the appropriate button
            if (activeTab === 'voting') {
                document.querySelector('.vote-button').classList.add('active');
            } else if (activeTab === 'submit') {
                document.querySelector('.submit-button').classList.add('active');
            } else if (activeTab === 'outcomes' || activeTab === 'profile') {
                document.querySelector('.hamburger-menu').classList.add('active');
            }
        }

        function updateContextualButton(currentTab) {
            const contextualButton = document.getElementById('contextualButton');
            
            if (currentTab === 'voting') {
                contextualButton.innerHTML = 'Submit Idea';
                contextualButton.onclick = () => showTab('submit');
                contextualButton.style.display = 'block';
            } else if (currentTab === 'submit') {
                contextualButton.innerHTML = 'Start Voting';
                contextualButton.onclick = () => showTab('voting');
                contextualButton.style.display = 'block';
            } else {
                // Hide contextual button on outcomes and profile pages
                // since they have dedicated navigation buttons
                contextualButton.style.display = 'none';
            }
        }

        function toggleMenu() {
            const sideMenu = document.getElementById('sideMenu');
            const menuOverlay = document.getElementById('menuOverlay');
            
            if (sideMenu.classList.contains('open')) {
                sideMenu.classList.remove('open');
                menuOverlay.classList.remove('open');
            } else {
                sideMenu.classList.add('open');
                menuOverlay.classList.add('open');
            }
        }

        function loadNextIdea() {
            // Initialize shuffled array if empty
            if (shuffledIdeas.length === 0) {
                shuffledIdeas = shuffleArray(ideas);
            }
            
            // If we've gone through all questions, reshuffle and start over
            if (currentIdeaIndex >= shuffledIdeas.length) {
                shuffledIdeas = shuffleArray(ideas);
                currentIdeaIndex = 0;
            }

            const idea = shuffledIdeas[currentIdeaIndex];
            updateCard(idea);
            
            // Re-setup swipe functionality for the new card
            setTimeout(() => {
                setupSwipeFunctionality();
            }, 100);
        }

        function updateCard(idea) {
            // Safety check - ensure idea exists and has required properties
            if (!idea || !idea.category || !idea.title || !idea.author) {
                console.error('Invalid idea object:', idea);
                return;
            }
            
            document.getElementById('ideaCategory').textContent = idea.category;
            document.getElementById('ideaTitle').textContent = idea.title;
            document.getElementById('ideaAuthor').textContent = ` ${idea.author}`;
            document.getElementById('goodVotes').textContent = idea.votes.good || 0;
            document.getElementById('badVotes').textContent = idea.votes.bad || 0;

            // Handle metadata display
            const qualityBadge = document.getElementById('qualityBadge');
            const reputationScore = document.getElementById('reputationScore');
            const tierBadge = document.getElementById('tierBadge');
            const targetAudience = document.getElementById('targetAudience');

            // Quality badge
            if (idea.qualityBadge) {
                qualityBadge.textContent = idea.qualityBadge;
                qualityBadge.className = `quality-badge ${idea.qualityBadge}`;
                qualityBadge.style.display = 'inline-block';
            } else {
                qualityBadge.style.display = 'none';
            }

            // Reputation score
            if (idea.reputation) {
                const stars = reputationScore.querySelector('.stars');
                const score = reputationScore.querySelector('.score');
                
                // Create star rating
                const fullStars = Math.floor(idea.reputation);
                const hasHalfStar = idea.reputation % 1 >= 0.5;
                stars.textContent = ''.repeat(fullStars) + (hasHalfStar ? '' : '') + ''.repeat(5 - fullStars - (hasHalfStar ? 1 : 0));
                score.textContent = idea.reputation.toFixed(1);
                reputationScore.style.display = 'flex';
            } else {
                reputationScore.style.display = 'none';
            }

            // Tier badge
            if (idea.tier) {
                tierBadge.textContent = idea.tier;
                tierBadge.className = `tier-badge ${idea.tier}`;
                tierBadge.style.display = 'inline-block';
            } else {
                tierBadge.style.display = 'none';
            }

            // Target audience
            if (idea.targetAudience) {
                targetAudience.textContent = `Target: ${idea.targetAudience}`;
                targetAudience.style.display = 'block';
            } else {
                targetAudience.style.display = 'none';
            }

            // Handle description with read more functionality
            const description = document.getElementById('ideaDescription');
            description.textContent = idea.description;
            
            // Always remove any existing read more button first
            const existingReadMoreBtn = description.nextElementSibling;
            if (existingReadMoreBtn && existingReadMoreBtn.classList.contains('read-more')) {
                existingReadMoreBtn.remove();
            }
            
            // Check if description needs truncation
            if (idea.description.length > 150) {
                description.classList.add('truncated');
                // Add read more button
                const readMoreBtn = document.createElement('div');
                readMoreBtn.className = 'read-more';
                readMoreBtn.textContent = 'Read more';
                readMoreBtn.style.cssText = 'cursor: pointer; padding: 5px; margin-top: 5px; color: #667eea; font-weight: bold; font-size: 0.9rem;';
                readMoreBtn.addEventListener('click', () => toggleReadMore(readMoreBtn));
                readMoreBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    toggleReadMore(readMoreBtn);
                });
                description.parentNode.insertBefore(readMoreBtn, description.nextSibling);
            } else {
                description.classList.remove('truncated');
            }

            // Handle media
            const mediaContainer = document.getElementById('mediaContainer');
            if (idea.media) {
                mediaContainer.style.display = 'block';
                if (idea.media.type === 'image') {
                    mediaContainer.innerHTML = `
                        <img src="${idea.media.url}" alt="${idea.media.caption}" class="media-image">
                        <div class="media-caption">${idea.media.caption}</div>
                    `;
                } else if (idea.media.type === 'video') {
                    mediaContainer.innerHTML = `
                        <video src="${idea.media.url}" class="media-video" autoplay muted loop controls disablePictureInPicture>
                            Your browser does not support the video tag.
                        </video>
                        <div class="media-caption">${idea.media.caption}</div>
                    `;
                    
                    // Limit video playback to 10 seconds
                    const video = mediaContainer.querySelector('.media-video');
                    if (video) {
                        video.addEventListener('loadedmetadata', () => {
                            // Stop video after 10 seconds
                            setTimeout(() => {
                                video.pause();
                                video.currentTime = 0;
                            }, 10000);
                        });
                    }
                }
            } else {
                mediaContainer.style.display = 'none';
            }

            // Handle question type
            const goodBadLayout = document.getElementById('goodBadLayout');
            const choiceLayout = document.getElementById('choiceLayout');
            const goodBadButtons = document.getElementById('goodBadButtons');
            const choiceButtons = document.getElementById('choiceButtons');
            const questionTypeIndicator = document.getElementById('questionTypeIndicator');

            if (idea.type === 'choice') {
                goodBadLayout.style.display = 'none';
                choiceLayout.style.display = 'block';
                goodBadButtons.style.display = 'none';
                choiceButtons.style.display = 'flex';
                questionTypeIndicator.textContent = 'Choice';
                questionTypeIndicator.className = 'question-type-indicator choice';
                
                document.getElementById('choiceA').textContent = idea.choiceA;
                document.getElementById('choiceB').textContent = idea.choiceB;
                document.getElementById('votesA').textContent = `${idea.votes.a || 0} votes`;
                document.getElementById('votesB').textContent = `${idea.votes.b || 0} votes`;
                document.getElementById('choiceAuthor').textContent = ` ${idea.author}`;
            } else {
                goodBadLayout.style.display = 'block';
                choiceLayout.style.display = 'none';
                goodBadButtons.style.display = 'flex';
                choiceButtons.style.display = 'none';
                questionTypeIndicator.textContent = 'Good/Bad';
                questionTypeIndicator.className = 'question-type-indicator good-bad';
            }

            // Setup follow button with proper touch handling
            const followButton = document.getElementById('followButton');
            followButton.onclick = () => followIdea();
            followButton.ontouchend = (e) => {
                e.preventDefault();
                followIdea();
            };
        }

        function vote(voteType) {
            const idea = shuffledIdeas[currentIdeaIndex];
            
            if (voteType === 'good') {
                goodCount++;
                idea.votes.good++;
                showVoteOverlay('good', ' GOOD IDEA!');
            } else if (voteType === 'bad') {
                badCount++;
                idea.votes.bad++;
                showVoteOverlay('bad', ' BAD IDEA!');
            } else if (voteType === 'skip') {
                skippedCount++;
                showVoteOverlay('skip', ' SKIPPED');
            }

            // Move to next idea after overlay
            setTimeout(() => {
                currentIdeaIndex++;
                
                // Debug logging
                console.log('Vote function - currentIdeaIndex:', currentIdeaIndex);
                console.log('shuffledIdeas length:', shuffledIdeas.length);
                console.log('First idea isGrouped:', shuffledIdeas[0]?.isGrouped);
                
                // Check if we're in a grouped question session and if it's complete
                const currentGroup = questionGroups.find(g => g.name === "NBA Rule Changes 2024");
                console.log('Current group:', currentGroup);
                console.log('Array comparison:', shuffledIdeas === sportsGroupedQuestions);
                
                // Simple fix: check if we're past the last question and using grouped questions
                const isGroupedSession = shuffledIdeas.length > 0 && shuffledIdeas[0].isGrouped;
                if (currentGroup && isGroupedSession && currentIdeaIndex >= currentGroup.questionCount) {
                    console.log('SHOWING COMPLETION SCREEN');
                    // Group is complete, show completion screen
                    showGroupCompletion(currentGroup);
                    return; // Don't continue to loadNextIdea
                } else {
                    console.log('Continuing to next question');
                    // Continue to next question
                    loadNextIdea();
                    updateGroupProgress();
                }
            }, 800);

            // Show engagement prompt every 5 votes
            if ((goodCount + badCount + skippedCount) % 5 === 0) {
                setTimeout(() => {
                    showEngagementPrompt();
                }, 1000);
            }
        }

        function voteChoice(choice) {
            const idea = shuffledIdeas[currentIdeaIndex];
            idea.votes[choice]++;
            
            // Update vote display
            document.getElementById(`votes${choice.toUpperCase()}`).textContent = `${idea.votes[choice]} votes`;
            
            // Show choice-specific overlay
            const choiceText = choice === 'a' ? idea.choiceA : idea.choiceB;
            const overlayClass = choice === 'a' ? 'choice-a' : 'choice-b';
            showVoteOverlay(overlayClass, ` ${choiceText}`);
            
            // Move to next idea after overlay
            // TODO: Add completion check here like in vote() function
            setTimeout(() => {
                currentIdeaIndex++;
                
                // Debug logging
                console.log('Vote function - currentIdeaIndex:', currentIdeaIndex);
                console.log('shuffledIdeas length:', shuffledIdeas.length);
                console.log('First idea isGrouped:', shuffledIdeas[0]?.isGrouped);
                
                // Check if we're in a grouped question session and if it's complete
                const currentGroup = questionGroups.find(g => g.name === "NBA Rule Changes 2024");
                console.log('Current group:', currentGroup);
                console.log('Array comparison:', shuffledIdeas === sportsGroupedQuestions);
                
                // Simple fix: check if we're past the last question and using grouped questions
                const isGroupedSession = shuffledIdeas.length > 0 && shuffledIdeas[0].isGrouped;
                if (currentGroup && isGroupedSession && currentIdeaIndex >= currentGroup.questionCount) {
                    console.log('SHOWING COMPLETION SCREEN');
                    // Group is complete, show completion screen
                    showGroupCompletion(currentGroup);
                    return; // Don't continue to loadNextIdea
                } else {
                    console.log('Continuing to next question');
                    // Continue to next question
                    loadNextIdea();
                    updateGroupProgress();
                }
            }, 800);
        }

        function showVoteOverlay(type, text) {
            const card = document.getElementById('currentCard');
            
            // Remove any existing overlay
            const existingOverlay = card.querySelector('.vote-overlay');
            if (existingOverlay) {
                existingOverlay.remove();
            }
            
            // Create new overlay
            const overlay = document.createElement('div');
            overlay.className = `vote-overlay ${type}`;
            overlay.textContent = text;
            
            // Add overlay to card
            card.appendChild(overlay);
            
            // Remove overlay after animation
            setTimeout(() => {
                if (overlay.parentNode) {
                    overlay.remove();
                }
            }, 600);
        }

        function showEngagementPrompt() {
            const prompt = document.getElementById('engagementPrompt');
            prompt.style.display = 'block';
            
            setTimeout(() => {
                prompt.style.display = 'none';
            }, 8000);
        }

        function continueVoting() {
            document.getElementById('engagementPrompt').style.display = 'none';
        }

        function followIdea() {
            const idea = shuffledIdeas[currentIdeaIndex];
            if (!followedIdeas.includes(idea.id)) {
                followedIdeas.push(idea.id);
                showNotification('Idea followed! You\'ll get updates on the outcome.');
            } else {
                followedIdeas = followedIdeas.filter(id => id !== idea.id);
                showNotification('Idea unfollowed.');
            }
        }

        function showOutcomeDashboard() {
            const dashboard = document.getElementById('outcomeDashboard');
            dashboard.style.display = 'flex';
            
            // Populate followed ideas
            const followedIdeasContainer = document.getElementById('followedIdeas');
            const followedIdeasList = ideas.filter(idea => followedIdeas.includes(idea.id));
            
            if (followedIdeasList.length === 0) {
                followedIdeasContainer.innerHTML = '<p>You haven\'t followed any ideas yet. Vote on some ideas and follow them to see outcomes here!</p>';
            } else {
                followedIdeasContainer.innerHTML = followedIdeasList.map(idea => `
                    <div style="border: 1px solid #eee; border-radius: 10px; padding: 15px; margin: 10px 0;">
                        <h3>${idea.title}</h3>
                        <p>${idea.description.substring(0, 100)}...</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
                            <span> ${idea.votes.good || 0}</span>
                            <span> ${idea.votes.bad || 0}</span>
                            <span style="color: #667eea;">Following</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        function closeOutcomeDashboard() {
            document.getElementById('outcomeDashboard').style.display = 'none';
        }

        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #333;
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        function updateProfileData() {
            document.getElementById('profileReputation').textContent = userProfile.reputation;
            document.getElementById('profileIdeasVoted').textContent = userProfile.ideasVoted;
            updateRecentActivity();
        }

        // Initialize tier selection
        document.querySelector('.tier-option.free').classList.add('selected');

        // Initialize the app
        // updateCard(); // This was causing the error - removed
        // updateStats(); // This function doesn't exist - removed

        let selectedTier = 'free';
        let userProfile = {
            name: 'User',
            reputation: 85,
            ideasSubmitted: 12,
            votesCast: 156,
            badges: ['verified', 'expert'],
            groups: []
        };

        // Grouped Questions Feature
        let questionGroups = [];
        let pendingInvitations = [];

        // Pre-made sports-themed grouped question set for testing
        const sportsGroupedQuestions = [
            {
                id: 1,
                title: "Should the NBA implement a 4-point shot?",
                description: "The NBA is considering adding a 4-point shot from beyond 30 feet to increase scoring and excitement. This would reward players with exceptional range and potentially change game strategies significantly.",
                category: "Sports",
                author: "NBA Commissioner",
                votes: { good: 45, bad: 55 },
                type: "good-bad",
                media: null,
                isGrouped: true,
                groupName: "NBA Rule Changes 2024",
                groupIncentive: "Get early access to NBA rule change announcements"
            },
            {
                id: 2,
                title: "Soccer vs Basketball for youth development",
                description: "I'm choosing a sport for my 8-year-old child. Soccer offers teamwork and endurance, while basketball develops coordination and quick thinking. Both are great for fitness and social skills.",
                category: "Sports",
                author: "Parent",
                votes: { a: 62, b: 38 },
                type: "choice",
                choiceA: "Soccer",
                choiceB: "Basketball",
                media: null,
                isGrouped: true,
                groupName: "NBA Rule Changes 2024",
                groupIncentive: "Get early access to NBA rule change announcements"
            },
            {
                id: 3,
                title: "Should college athletes be paid?",
                description: "College sports generate billions in revenue, but athletes receive no direct compensation beyond scholarships. Should we implement a payment system for college athletes?",
                category: "Sports",
                author: "Sports Analyst",
                votes: { good: 78, bad: 22 },
                type: "good-bad",
                media: null,
                isGrouped: true,
                groupName: "NBA Rule Changes 2024",
                groupIncentive: "Get early access to NBA rule change announcements"
            },
            {
                id: 4,
                title: "Traditional training vs technology-based coaching",
                description: "Modern sports training uses AI, wearables, and data analytics, while traditional methods rely on experience and intuition. Which approach produces better athletes?",
                category: "Sports",
                author: "Coach",
                votes: { a: 35, b: 65 },
                type: "choice",
                choiceA: "Traditional",
                choiceB: "Technology",
                media: null,
                isGrouped: true,
                groupName: "NBA Rule Changes 2024",
                groupIncentive: "Get early access to NBA rule change announcements"
            },
            {
                id: 5,
                title: "Should esports be considered real sports?",
                description: "Esports require strategy, teamwork, and reflexes similar to traditional sports. Should competitive gaming be recognized as legitimate sports with the same respect and opportunities?",
                category: "Sports",
                author: "Gaming Enthusiast",
                votes: { good: 65, bad: 35 },
                type: "good-bad",
                media: null,
                isGrouped: true,
                groupName: "NBA Rule Changes 2024",
                groupIncentive: "Get early access to NBA rule change announcements"
            }
        ];

        // Auto-trigger sports group invitation for testing
        function triggerSportsGroupInvitation() {
            console.log('Triggering sports group invitation...');
            
            const sportsGroup = {
                id: Date.now(),
                name: "NBA Rule Changes 2024",
                description: "Help shape the future of basketball by providing feedback on proposed rule changes",
                targetEmails: ["test@example.com"],
                incentiveMessage: "Get early access to NBA rule change announcements and exclusive behind-the-scenes content",
                questionCount: 5,
                status: 'active',
                createdAt: new Date(),
                responses: 0,
                totalInvited: 1
            };

            console.log('Sports group created:', sportsGroup);

            // Add to groups
            questionGroups.push(sportsGroup);
            console.log('Question groups:', questionGroups);

            // Show invitation after a short delay
            setTimeout(() => {
                console.log('Showing group invitation notification...');
                showGroupInvitationNotification("test@example.com", sportsGroup);
            }, 15000); // Show after 15 seconds
        }

        function selectTier(tier) {
            selectedTier = tier;
            
            // Update tier selection UI
            document.querySelectorAll('.tier-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`.tier-option.${tier}`).classList.add('selected');
            
            // Show/hide grouped questions section based on tier
            const groupedSection = document.getElementById('groupedQuestionsSection');
            if (tier === 'free') {
                groupedSection.innerHTML = `
                    <div class="premium-lock">
                        <h4> Premium Feature</h4>
                        <p>Grouped Questions is available for Premium, Pro, and Enterprise tiers.</p>
                        <button class="upgrade-button" onclick="showUpgradeModal()">Upgrade Now</button>
                    </div>
                `;
            } else {
                groupedSection.innerHTML = `
                    <h3> Create Grouped Questions</h3>
                    <p>Send targeted question groups to specific people for focused feedback</p>
                    
                    <div class="group-creation">
                        <div class="form-group">
                            <label for="groupName">Group Name *</label>
                            <input type="text" id="groupName" placeholder="e.g., 'Product Launch Feedback', 'Team Decision Making'">
                        </div>
                        
                        <div class="form-group">
                            <label for="groupDescription">Group Description</label>
                            <textarea id="groupDescription" placeholder="Explain what this group of questions is about and why you're targeting specific people"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="targetEmails">Target Recipients (Email addresses, one per line)</label>
                            <textarea id="targetEmails" placeholder="john@company.com&#10;jane@company.com&#10;mike@company.com"></textarea>
                            <div class="char-count">
                                <span id="emailCount">0</span> recipients
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="incentiveMessage">Incentive Message</label>
                            <textarea id="incentiveMessage" placeholder="What's in it for them? e.g., 'Get early access to our new feature' or 'Receive a $50 gift card'"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="questionCount">Number of Questions in Group</label>
                            <select id="questionCount">
                                <option value="5">5 questions</option>
                                <option value="10" selected>10 questions</option>
                                <option value="15">15 questions</option>
                                <option value="20">20 questions</option>
                            </select>
                        </div>
                        
                        <button class="create-group-button" onclick="createQuestionGroup()">Create Group & Send Invitations</button>
                    </div>
                `;
            }
            groupedSection.style.display = 'block';
            
            // Update character limits based on tier
            updateCharacterLimits();
        }

        function updateEmailCount() {
            const emails = document.getElementById('targetEmails').value;
            const emailCount = emails.split('\n').filter(email => email.trim() !== '').length;
            document.getElementById('emailCount').textContent = emailCount;
        }

        function createQuestionGroup() {
            const groupName = document.getElementById('groupName').value.trim();
            const groupDescription = document.getElementById('groupDescription').value.trim();
            const targetEmails = document.getElementById('targetEmails').value.trim();
            const incentiveMessage = document.getElementById('incentiveMessage').value.trim();
            const questionCount = parseInt(document.getElementById('questionCount').value);

            if (!groupName || !targetEmails) {
                showNotification('Please fill in the group name and target emails');
                return;
            }

            const emails = targetEmails.split('\n').filter(email => email.trim() !== '');
            if (emails.length === 0) {
                showNotification('Please enter at least one email address');
                return;
            }

            // Check tier limits
            const maxGroups = selectedTier === 'premium' ? 3 : selectedTier === 'pro' ? 10 : Infinity;
            if (questionGroups.length >= maxGroups) {
                showNotification(`You've reached the limit of ${maxGroups} groups for your ${selectedTier} tier`);
                return;
            }

            // Create the group
            const group = {
                id: Date.now(),
                name: groupName,
                description: groupDescription,
                targetEmails: emails,
                incentiveMessage: incentiveMessage,
                questionCount: questionCount,
                status: 'active',
                createdAt: new Date(),
                responses: 0,
                totalInvited: emails.length
            };

            questionGroups.push(group);

            // Send invitations (simulate)
            emails.forEach(email => {
                sendGroupInvitation(email, group);
            });

            showNotification(`Group "${groupName}" created! Invitations sent to ${emails.length} recipients.`);
            
            // Reset form
            document.getElementById('groupName').value = '';
            document.getElementById('groupDescription').value = '';
            document.getElementById('targetEmails').value = '';
            document.getElementById('incentiveMessage').value = '';
            document.getElementById('emailCount').textContent = '0';
        }

        function sendGroupInvitation(email, group) {
            // Simulate sending invitation
            setTimeout(() => {
                showGroupInvitationNotification(email, group);
            }, Math.random() * 3000 + 1000); // Random delay between 1-4 seconds
        }

        function showGroupInvitationNotification(email, group) {
            console.log('showGroupInvitationNotification called with:', { email, group });
            
            const notification = document.createElement('div');
            notification.className = 'group-invitation-notification';
            notification.innerHTML = `
                <h4> You've Been Selected!</h4>
                <p>You've been specially invited to answer a group of questions about: <strong>${group.name}</strong></p>
                ${group.incentiveMessage ? `<div class="incentive"> ${group.incentiveMessage}</div>` : ''}
                <p>This group contains ${group.questionCount} focused questions to help with decision making.</p>
                <div class="group-invitation-buttons">
                    <button class="accept-group-btn" onclick="acceptGroupInvitation('${group.id}', this)">Accept & Start</button>
                    <button class="decline-group-btn" onclick="declineGroupInvitation(this)">Maybe Later</button>
                </div>
            `;
            
            console.log('Notification element created:', notification);
            document.body.appendChild(notification);
            console.log('Notification added to body');
            
            // Auto-remove after 30 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 30000);
        }

        function acceptGroupInvitation(groupId, button) {
            const group = questionGroups.find(g => g.id == groupId);
            if (group) {
                group.responses++;
                showNotification(`Great! Starting your ${group.questionCount}-question group about "${group.name}"`);
                
                // Switch to voting tab and load grouped questions
                showTab('voting');
                loadGroupedQuestions(group);
            }
            
            // Remove notification
            button.closest('.group-invitation-notification').remove();
        }

        function declineGroupInvitation(button) {
            showNotification('No problem! You can always accept later if you change your mind.');
            button.closest('.group-invitation-notification').remove();
        }

        function loadGroupedQuestions(group) {
            // Use the pre-made sports questions for the NBA group
            if (group.name === "NBA Rule Changes 2024") {
                shuffledIdeas = [...sportsGroupedQuestions];
            } else {
                // For other groups, use existing questions but mark them as grouped
                const groupedIdeas = shuffleArray(ideas).slice(0, group.questionCount);
                
                // Mark these as grouped questions
                groupedIdeas.forEach(idea => {
                    idea.isGrouped = true;
                    idea.groupName = group.name;
                    idea.groupIncentive = group.incentiveMessage;
                });
                
                shuffledIdeas = groupedIdeas;
            }
            
            currentIdeaIndex = 0;
            loadNextIdea();
            
            // Show grouped question indicator
            showGroupedQuestionIndicator(group);
        }

        function showGroupedQuestionIndicator(group) {
            // Remove any existing indicator first
            const existingIndicator = document.querySelector('.grouped-question-indicator');
            if (existingIndicator) {
                existingIndicator.remove();
            }
            
            const indicator = document.createElement('div');
            indicator.className = 'grouped-question-indicator';
            indicator.innerHTML = `
                <div class="group-header">
                    <div class="group-info">
                        <h4> ${group.name}</h4>
                        <p class="group-progress">Question ${currentIdeaIndex + 1} of ${group.questionCount}</p>
                        ${group.incentiveMessage ? `<p class="group-incentive"> ${group.incentiveMessage}</p>` : ''}
                    </div>
                    <button class="exit-group-btn" onclick="exitGroupedQuestions()" title="Exit Group">
                        
                    </button>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${((currentIdeaIndex + 1) / group.questionCount) * 100}%"></div>
                </div>
            `;
            
            // Insert above the card container instead of inside it
            const cardContainer = document.getElementById('cardContainer');
            const votingTab = document.getElementById('voting-tab');
            votingTab.insertBefore(indicator, cardContainer);
        }

        function showUpgradeModal() {
            showNotification('Upgrade to Premium, Pro, or Enterprise to unlock Grouped Questions!');
        }

        function updateCharacterLimits() {
            const descTextarea = document.getElementById('ideaDescription');
            const descCount = document.getElementById('descCount');
            const premiumLimit = document.getElementById('premiumLimit');
            
            if (!descTextarea) return; // Function might be called before elements exist
            
            switch(selectedTier) {
                case 'free':
                    descTextarea.maxLength = 300;
                    descCount.textContent = descTextarea.value.length;
                    premiumLimit.style.display = 'none';
                    break;
                case 'premium':
                    descTextarea.maxLength = 500;
                    descCount.textContent = descTextarea.value.length;
                    premiumLimit.textContent = ' (Premium: 500 chars)';
                    premiumLimit.style.display = 'inline';
                    break;
                case 'pro':
                    descTextarea.maxLength = 750;
                    descCount.textContent = descTextarea.value.length;
                    premiumLimit.textContent = ' (Pro: 750 chars)';
                    premiumLimit.style.display = 'inline';
                    break;
                case 'enterprise':
                    descTextarea.maxLength = 1000;
                    descCount.textContent = descTextarea.value.length;
                    premiumLimit.textContent = ' (Enterprise: 1000 chars)';
                    premiumLimit.style.display = 'inline';
                    break;
            }
        }

        function toggleReadMore(element) {
            const description = element.previousElementSibling;
            if (description.classList.contains('truncated')) {
                description.classList.remove('truncated');
                element.textContent = 'Read less';
            } else {
                description.classList.add('truncated');
                element.textContent = 'Read more';
            }
        }

        function submitIdea() {
            const title = document.getElementById('ideaTitle').value.trim();
            const description = document.getElementById('ideaDescription').value.trim();
            const category = document.getElementById('ideaCategory').value;
            const targetAudience = document.getElementById('targetAudience').value.trim();
            const visibility = document.getElementById('visibility').value;
            const privateGroup = document.getElementById('privateGroup').value.trim();

            if (!title || !description || !category) {
                showNotification('Please fill in all required fields');
                return;
            }

            // Create new idea object
            const newIdea = {
                id: ideas.length + 1,
                title: title,
                description: description,
                category: category,
                author: userProfile.name,
                votes: { good: 0, bad: 0 },
                tier: selectedTier,
                visibility: visibility,
                target: targetAudience || null,
                group: visibility === 'private' ? privateGroup : null,
                outcome: {
                    status: 'pending',
                    decision: null,
                    progress: [],
                    finalResult: null
                }
            };

            // Add to ideas array
            ideas.unshift(newIdea);

            // Update user stats
            userProfile.ideasSubmitted++;

            // Show success message
            showNotification('Idea submitted successfully! It will be reviewed shortly.');

            // Reset form
            document.getElementById('ideaTitle').value = '';
            document.getElementById('ideaDescription').value = '';
            document.getElementById('ideaCategory').value = '';
            document.getElementById('targetAudience').value = '';
            document.getElementById('visibility').value = 'public';
            document.getElementById('privateGroup').value = '';
            document.querySelectorAll('.tier-option').forEach(option => {
                option.classList.remove('selected');
            });

            // Switch back to voting tab
            showTab('voting');
        }

        function updateRecentActivity() {
            const recentActivity = document.getElementById('recentActivity');
            const activities = [
                { action: 'Voted on', idea: 'Should I learn Rust for backend development?', time: '2 hours ago' },
                { action: 'Submitted', idea: 'Should I start a food blog?', time: '1 day ago' },
                { action: 'Followed outcome for', idea: 'Should I launch my indie game on Steam Early Access?', time: '3 days ago' },
                { action: 'Achieved', idea: 'Expert badge', time: '1 week ago' }
            ];

            recentActivity.innerHTML = activities.map(activity => `
                <div style="padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <strong>${activity.action}</strong> ${activity.idea}
                    </div>
                    <div style="font-size: 0.8rem; color: #666;">${activity.time}</div>
                </div>
            `).join('');
        }

        // Group Management Functions
        function inviteToGroup(groupName) {
            showNotification(`Invite sent to join ${groupName}!`);
        }

        function sendInvite() {
            const email = event.target.previousElementSibling.value;
            if (email) {
                showNotification(`Invite sent to ${email}!`);
                event.target.previousElementSibling.value = '';
            } else {
                showNotification('Please enter an email address');
            }
        }

        function createNewGroup() {
            const groupName = prompt('Enter group name:');
            if (groupName) {
                showNotification(`New group "${groupName}" created!`);
            }
        }

        function updateGroupActivity() {
            // This would update group activity in a real app
            console.log('Group activity updated');
        }

        // Handle visibility change
        document.getElementById('visibility').addEventListener('change', function() {
            const privateGroupSection = document.getElementById('privateGroupSection');
            if (this.value === 'private') {
                privateGroupSection.style.display = 'block';
            } else {
                privateGroupSection.style.display = 'none';
            }
        });

        // Character counting and form validation
        document.getElementById('ideaTitle').addEventListener('input', function() {
            const count = this.value.length;
            document.getElementById('titleCount').textContent = count;
        });

        document.getElementById('ideaDescription').addEventListener('input', function() {
            const count = this.value.length;
            document.getElementById('descCount').textContent = count;
            
            // Show premium limit indicator
            const premiumLimit = document.getElementById('premiumLimit');
            if (selectedTier !== 'free' && count > 300) {
                premiumLimit.style.display = 'inline';
            } else {
                premiumLimit.style.display = 'none';
            }
        });

        function populateFollowedIdeas() {
            // Populate followed ideas
            const followedIdeasContainer = document.getElementById('followedIdeas');
            const followedIdeasList = ideas.filter(idea => followedIdeas.includes(idea.id));
            
            if (followedIdeasList.length === 0) {
                followedIdeasContainer.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">You haven\'t followed any ideas yet. Vote on some ideas and follow them to see outcomes here!</p>';
            } else {
                followedIdeasContainer.innerHTML = followedIdeasList.map(idea => {
                    // Generate outcome status and progress
                    const totalVotes = (idea.votes.good || 0) + (idea.votes.bad || 0) + (idea.votes.a || 0) + (idea.votes.b || 0);
                    const outcomeStatus = totalVotes > 50 ? 'Completed' : totalVotes > 20 ? 'In Progress' : 'Gathering Votes';
                    const progressPercentage = Math.min((totalVotes / 50) * 100, 100);
                    
                    // Generate decision result
                    let decisionResult = '';
                    if (idea.type === 'choice') {
                        const choiceAVotes = idea.votes.a || 0;
                        const choiceBVotes = idea.votes.b || 0;
                        if (choiceAVotes > choiceBVotes) {
                            decisionResult = ` Community chose: ${idea.choiceA}`;
                        } else if (choiceBVotes > choiceAVotes) {
                            decisionResult = ` Community chose: ${idea.choiceB}`;
                        } else {
                            decisionResult = ' Community is split';
                        }
                    } else {
                        const goodVotes = idea.votes.good || 0;
                        const badVotes = idea.votes.bad || 0;
                        if (goodVotes > badVotes) {
                            decisionResult = ' Community says: GOOD IDEA';
                        } else if (badVotes > goodVotes) {
                            decisionResult = ' Community says: BAD IDEA';
                        } else {
                            decisionResult = ' Community is split';
                        }
                    }
                    
                    // Generate metadata display
                    const metadataDisplay = [];
                    if (idea.qualityBadge) {
                        metadataDisplay.push(`<span class="quality-badge ${idea.qualityBadge}">${idea.qualityBadge}</span>`);
                    }
                    if (idea.reputation) {
                        const fullStars = Math.floor(idea.reputation);
                        const hasHalfStar = idea.reputation % 1 >= 0.5;
                        const stars = ''.repeat(fullStars) + (hasHalfStar ? '' : '') + ''.repeat(5 - fullStars - (hasHalfStar ? 1 : 0));
                        metadataDisplay.push(`<span class="reputation-score"><span class="stars">${stars}</span> <span class="score">${idea.reputation.toFixed(1)}</span></span>`);
                    }
                    if (idea.tier) {
                        metadataDisplay.push(`<span class="tier-badge ${idea.tier}">${idea.tier}</span>`);
                    }
                    
                    return `
                        <div style="border: 1px solid #eee; border-radius: 10px; padding: 20px; margin: 15px 0; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold;">${idea.category}</span>
                                        ${metadataDisplay.join('')}
                                    </div>
                                    <h3 style="margin: 0 0 8px 0; color: #333; font-size: 1.1rem;">${idea.title}</h3>
                                    <p style="color: #666; margin: 0 0 12px 0; line-height: 1.4;">${idea.description}</p>
                                    ${idea.targetAudience ? `<p style="color: #667eea; font-size: 0.8rem; margin: 0 0 8px 0;"><strong>Target:</strong> ${idea.targetAudience}</p>` : ''}
                                    <p style="color: #888; font-size: 0.8rem; margin: 0;"> ${idea.author}</p>
                                </div>
                                <div style="text-align: right; margin-left: 15px;">
                                    <div style="background: ${outcomeStatus === 'Completed' ? '#4caf50' : outcomeStatus === 'In Progress' ? '#ff9800' : '#9e9e9e'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold; margin-bottom: 8px;">
                                        ${outcomeStatus}
                                    </div>
                                    <div style="font-size: 0.8rem; color: #666;">
                                        ${totalVotes} total votes
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin: 12px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                    <span style="font-size: 0.8rem; color: #666;">Progress</span>
                                    <span style="font-size: 0.8rem; color: #666;">${Math.round(progressPercentage)}%</span>
                                </div>
                                <div style="background: #f0f0f0; border-radius: 10px; height: 6px; overflow: hidden;">
                                    <div style="background: linear-gradient(90deg, #667eea, #764ba2); height: 100%; width: ${progressPercentage}%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; margin: 12px 0;">
                                <div style="display: flex; gap: 15px;">
                                    ${idea.type === 'choice' ? `
                                        <span style="color: #2ed573; font-weight: bold;"> ${idea.choiceA}: ${idea.votes.a || 0}</span>
                                        <span style="color: #ff4757; font-weight: bold;"> ${idea.choiceB}: ${idea.votes.b || 0}</span>
                                    ` : `
                                        <span style="color: #2ed573; font-weight: bold;"> ${idea.votes.good || 0}</span>
                                        <span style="color: #ff4757; font-weight: bold;"> ${idea.votes.bad || 0}</span>
                                    `}
                                </div>
                                <span style="color: #667eea; font-weight: bold; font-size: 0.9rem;">Following</span>
                            </div>
                            
                            ${outcomeStatus === 'Completed' ? `
                                <div style="background: #f8f9fa; border-left: 4px solid #4caf50; padding: 12px; border-radius: 4px; margin-top: 12px;">
                                    <div style="font-weight: bold; color: #333; margin-bottom: 4px;">Final Decision:</div>
                                    <div style="color: #4caf50; font-weight: bold;">${decisionResult}</div>
                                </div>
                            ` : ''}
                            
                            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                                <button style="background: #667eea; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer;" onclick="unfollowIdea(${idea.id})">Unfollow</button>
                                <button style="background: #f0f0f0; color: #666; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer;" onclick="shareOutcome(${idea.id})">Share</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function exitGroupedQuestions() {
            // Reset to regular questions
            shuffledIdeas = shuffleArray(ideas);
            currentIdeaIndex = 0;
            
            // Remove grouped question indicator
            const indicator = document.querySelector('.grouped-question-indicator');
            if (indicator) {
                indicator.remove();
            }
            
            // Load next regular idea
            loadNextIdea();
            
            showNotification('Returned to regular voting questions');
        }

        function updateGroupProgress() {
            const indicator = document.querySelector('.grouped-question-indicator');
            if (indicator) {
                const progressText = indicator.querySelector('.group-progress');
                const progressFill = indicator.querySelector('.progress-fill');
                if (progressText && progressFill) {
                    const currentGroup = questionGroups.find(g => g.name === "NBA Rule Changes 2024");
                    if (currentGroup) {
                        progressText.textContent = `Question ${currentIdeaIndex + 1} of ${currentGroup.questionCount}`;
                        progressFill.style.width = `${((currentIdeaIndex + 1) / currentGroup.questionCount) * 100}%`;
                    }
                }
            }
        }

        function showGroupCompletion(group) {
            // Remove grouped question indicator
            const indicator = document.querySelector('.grouped-question-indicator');
            if (indicator) {
                indicator.remove();
            }
            
            // Create completion screen
            const completionScreen = document.createElement('div');
            completionScreen.className = 'group-completion-screen';
            completionScreen.innerHTML = `
                <div class="completion-content">
                    <div class="completion-icon"></div>
                    <h2>Thank you for completing the grouped questions!</h2>
                    <p>You've successfully answered all ${group.questionCount} questions about <strong>${group.name}</strong>.</p>
                    ${group.incentiveMessage ? `<p class="completion-incentive"> ${group.incentiveMessage}</p>` : ''}
                    <p>Your feedback will help shape the future of this topic.</p>
                    <button class="return-to-voting-btn" onclick="returnToRegularVoting()">Continue Voting</button>
                </div>
            `;
            
            const cardContainer = document.getElementById('cardContainer');
            cardContainer.innerHTML = '';
            cardContainer.appendChild(completionScreen);
        }

        function returnToRegularVoting() {
            // Reset to regular questions
            shuffledIdeas = shuffleArray(ideas);
            currentIdeaIndex = 0;
            
            // Remove completion screen and restore card container
            const completionScreen = document.querySelector('.group-completion-screen');
            if (completionScreen) {
                completionScreen.remove();
            }
            
            // Restore the original card container HTML
            const cardContainer = document.getElementById('cardContainer');
            cardContainer.innerHTML = `
                <div class="card" id="currentCard">
                    <div class="card-content">
                        <div>
                            <div class="category" id="ideaCategory">Food</div>
                            <div class="metadata-row">
                                <div class="quality-badge" id="qualityBadge" style="display: none;"></div>
                                <div class="reputation-score" id="reputationScore" style="display: none;">
                                    <span class="stars"></span>
                                    <span class="score"></span>
                                </div>
                                <div class="tier-badge" id="tierBadge" style="display: none;"></div>
                            </div>
                            <h2 class="card-title" id="ideaTitle">Pizza for dinner tonight?</h2>
                            <p class="description" id="ideaDescription">Should we order pizza for dinner? I'm craving some pepperoni!</p>
                            <div class="target-audience" id="targetAudience" style="display: none;"></div>
                            <div class="media-container" id="mediaContainer" style="display: none;">
                                <!-- Media content will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- Good/Bad Question Layout -->
                        <div id="goodBadLayout">
                            <div class="author" id="ideaAuthor"> Sarah</div>
                            <div class="votes">
                                <div class="vote-count">
                                     <span id="goodVotes">45</span>
                                </div>
                                <div class="vote-count">
                                     <span id="badVotes">12</span>
                                </div>
                            </div>
                        </div>

                        <!-- Choice Question Layout -->
                        <div id="choiceLayout" style="display: none;">
                            <div class="author" id="choiceAuthor"> Sarah</div>
                            <div class="choice-options">
                                <div class="choice-option option-a" onclick="voteChoice('a')" ontouchend="event.preventDefault(); voteChoice('a');">
                                    <div class="choice-swipe"></div>
                                    <div class="choice-text" id="choiceA">Option A</div>
                                    <div class="choice-votes" id="votesA">0 votes</div>
                                </div>
                                <div class="choice-option option-b" onclick="voteChoice('b')" ontouchend="event.preventDefault(); voteChoice('b');">
                                    <div class="choice-swipe"></div>
                                    <div class="choice-text" id="choiceB">Option B</div>
                                    <div class="choice-votes" id="votesB">0 votes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="swipe-overlay" id="swipeOverlay"></div>
                    <button class="follow-button" id="followButton" onclick="followIdea()">Follow for Updates</button>
                    <div class="question-type-indicator" id="questionTypeIndicator">Good/Bad</div>
                </div>
            `;
            
            // Load next regular idea
            loadNextIdea();
            
            // Re-setup swipe functionality for the restored card
            setTimeout(() => {
                setupSwipeFunctionality();
            }, 300);
            
            showNotification('Welcome back to regular voting!');
        }

        function unfollowIdea(ideaId) {
            followedIdeas = followedIdeas.filter(id => id !== ideaId);
            populateFollowedIdeas();
            showNotification('Idea unfollowed successfully');
        }

        function shareOutcome(ideaId) {
            const idea = ideas.find(i => i.id === ideaId);
            if (idea) {
                const shareText = `Check out this community decision: "${idea.title}" - ${idea.description.substring(0, 100)}...`;
                if (navigator.share) {
                    navigator.share({
                        title: 'Community Decision',
                        text: shareText,
                        url: window.location.href
                    });
                } else {
                    // Fallback for browsers that don't support Web Share API
                    navigator.clipboard.writeText(shareText);
                    showNotification('Outcome copied to clipboard!');
                }
            }
        }
    </script>
</body>
</html> 